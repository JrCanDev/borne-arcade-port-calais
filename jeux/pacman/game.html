<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/game.css">

    <script src="../../js/i18n.js"></script>
    <script src="../../js/utils.js"></script>
    <script src="../../js/game.js"></script>
    <script src="../../js/global.js"></script>

    <meta charset="UTF-8">
    <meta name="application-name" data-i18n="application-name" data-i18n-field="content" content="Borne Port Calais">
    <meta name="author" content="Joshua VandaÃ«le">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" type="text/css" href="css/pacman.css" />
    <link rel="stylesheet" type="text/css" href="css/pacman-home.css" />

    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="js/jquery-buzz.js"></script>
    <script type="text/javascript" src="js/image-loader.js"></script>

    <script type="text/javascript" src="js/game.js"></script>
    <script type="text/javascript" src="js/tools.js"></script>
    <script type="text/javascript" src="js/board.js"></script>
    <script type="text/javascript" src="js/paths.js"></script>
    <script type="text/javascript" src="js/bubbles.js"></script>
    <script type="text/javascript" src="js/fruits.js"></script>
    <script type="text/javascript" src="js/pacman.js"></script>
    <script type="text/javascript" src="js/ghosts.js"></script>
    <script type="text/javascript" src="js/home.js"></script>
    <script type="text/javascript" src="js/sound.js"></script>
</head>

<body>
    <div id="left">
        <div class="rules">
            <h1 data-i18n="game.rules"></h1>
            <p data-i18n="game.pacman.rules"></p>
        </div>
        <button data-i18n="game.giveup" onclick="showGiveUp()"></button>
    </div>
    <div id="game-container">
        <div id="home">
            <canvas id="canvas-home-title-pacman"></canvas>
            <div id="presentation">
                <div id="presentation-titles">character &nbsp;/&nbsp; nickname</div>
                <canvas id="canvas-presentation-blinky"></canvas>
                <div id="presentation-character-blinky">- shadow</div>
                <div id="presentation-name-blinky">"blinky"</div>
                <canvas id="canvas-presentation-pinky"></canvas>
                <div id="presentation-character-pinky">- speedy</div>
                <div id="presentation-name-pinky">"pinky"</div>
                <canvas id="canvas-presentation-inky"></canvas>
                <div id="presentation-character-inky">- bashful</div>
                <div id="presentation-name-inky">"inky"</div>
                <canvas id="canvas-presentation-clyde"></canvas>
                <div id="presentation-character-clyde">- pokey</div>
                <div id="presentation-name-clyde">"clyde"</div>
            </div>
            <canvas id="trailer"></canvas>
        </div>
        <div id="panel">
          <canvas id="canvas-panel-title-pacman"></canvas>
          <div id="board">
            <canvas id="canvas-board"></canvas>
            <canvas id="canvas-paths"></canvas>
            <canvas id="canvas-bubbles"></canvas>
            <canvas id="canvas-fruits"></canvas>
            <canvas id="canvas-pacman"></canvas>
            <canvas id="canvas-ghost-blinky"></canvas>
            <canvas id="canvas-ghost-pinky"></canvas>
            <canvas id="canvas-ghost-inky"></canvas>
            <canvas id="canvas-ghost-clyde"></canvas>
          </div>
          <canvas id="canvas-lifes"></canvas>
          <canvas id="canvas-level-fruits"></canvas>
          <div id="message"></div>
        </div>
    </div>
    <div id="right">
        <div class="score">
            <h1 data-i18n="game.score"></h1>
            <p id="score"></p>
            <hr>
            <h1 data-i18n="game.highscore"></h1>
            <p id="highscore"></p>
        </div>
        <div class="controls">
            <ul>
                <li>
                    <span class="blank"></span>
                    <img src="../../img/up-arrow.svg" ontouchstart="emulateArrowClick('up')">
                    <span class="blank"></span>
                </li>
                <li>
                    <img src="../../img/left-arrow.svg" ontouchstart="emulateArrowClick('left')">
                    <span class="blank"></span>
                    <img src="../../img/right-arrow.svg" ontouchstart="emulateArrowClick('right')">
                </li>
                <li>
                    <span class="blank"></span>
                    <img src="../../img/down-arrow.svg" ontouchstart="emulateArrowClick('down')">
                    <span class="blank"></span>
                </li>
            </ul>
        </div>
    </div>

    <!-- Pop-up -->
    <div id="giveup" class="modal" style="display: none;">
        <h2 data-i18n="game.giveup.title"></h2>
        <p data-i18n="game.giveup.text"></p>
        <div class="buttons">
            <button onclick="nextPage()" data-i18n="game.giveup.yes"></button>
            <button onclick="hideGiveUp()" data-i18n="game.giveup.no"></button>
        </div>
    </div>

    <div id="gameover" class="modal" style="display: none;">
        <h2 data-i18n="game.gameover.title"></h2>
        <p data-i18n="game.gameover.text"></p>
        <div class="buttons">
            <button onclick="nextPage()" data-i18n="game.gameover.next"></button>
            <button onclick="hideGameOver()" data-i18n="game.gameover.retry"></button>
        </div>
    </div>

</body>

<script>
    function showGiveUp() {
        document.getElementById("giveup").style.display = "block";
    }

    function hideGiveUp() {
        document.getElementById("giveup").style.display = "none";
    }

    function showGameOver() {
        let gameover_text = translations["game.gameover.text"] + " " + document.getElementById("score").innerHTML;
        if (document.getElementById("score").innerHTML == document.getElementById("highscore").innerHTML) {
            gameover_text += translations["game.gameover.newhighscore"];
        }
        document.querySelector("#gameover p").innerHTML = gameover_text
        document.getElementById("gameover").style.display = "block";
        hideGiveUp();
    }

    function hideGameOver() {
        document.getElementById("gameover").style.display = "none";
        initScore("pacman");
    }

    function nextPage() {
        redirectToPage(event, '../../info.html?&game=pacman');
    }

    initScore("pacman");
</script>

<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "UA-121647007-2");
</script>

<script type="text/javascript">
    $(document).ready(function () {
        loadAllSound();

        HELP_TIMER = setInterval("blinkHelp()", HELP_DELAY);

        initHome();

        $(".sound").click(function (e) {
            e.stopPropagation();

            var sound = $(this).attr("data-sound");
            if (sound === "on") {
                $(".sound").attr("data-sound", "off");
                $(".sound").find("img").attr("src", "img/sound-off.png");
                GROUP_SOUND.mute();
            } else {
                $(".sound").attr("data-sound", "on");
                $(".sound").find("img").attr("src", "img/sound-on.png");
                GROUP_SOUND.unmute();
            }
        });

        $(".help-button, #help").click(function (e) {
            e.stopPropagation();
            if (!PACMAN_DEAD && !LOCK && !GAMEOVER) {
                if ($("#help").css("display") === "none") {
                    $("#help").fadeIn("slow");
                    $(".help-button").hide();
                    if ($("#panel").css("display") !== "none") {
                        pauseGame();
                    }
                } else {
                    $("#help").fadeOut("slow");
                    $(".help-button").show();
                }
            }
        });

        $(".github,.putchu").click(function (e) {
            e.stopPropagation();
        });

        $("#home").on("click touchstart", function (e) {
            if ($("#help").css("display") === "none") {
                e.preventDefault();
                simulateKeydown(13);
            }
        });
        $("#control-up, #control-up-second, #control-up-big").on(
            "mousedown touchstart",
            function (e) {
                e.preventDefault();
                simulateKeydown(38);
                simulateKeyup(13);
            }
        );
        $("#control-down, #control-down-second, #control-down-big").on(
            "mousedown touchstart",
            function (e) {
                e.preventDefault();
                simulateKeydown(40);
                simulateKeyup(13);
            }
        );
        $("#control-left, #control-left-big").on(
            "mousedown touchstart",
            function (e) {
                e.preventDefault();
                simulateKeydown(37);
                simulateKeyup(13);
            }
        );
        $("#control-right, #control-right-big").on(
            "mousedown touchstart",
            function (e) {
                e.preventDefault();
                simulateKeydown(39);
                simulateKeyup(13);
            }
        );

        $("body").keyup(function (e) {
            KEYDOWN = false;
        });

        $("body").keydown(function (e) {
            if (HOME) {
                initGame(true);
            } else {
                //if (!KEYDOWN) {
                KEYDOWN = true;
                if (PACMAN_DEAD && !LOCK) {
                    erasePacman();
                    resetPacman();
                    drawPacman();

                    eraseGhosts();
                    resetGhosts();
                    drawGhosts();
                    moveGhosts();

                    blinkSuperBubbles();
                } else if (
                    e.keyCode >= 37 &&
                    e.keyCode <= 40 &&
                    !PAUSE &&
                    !PACMAN_DEAD &&
                    !LOCK
                ) {
                    if (e.keyCode === 39) {
                        movePacman(1);
                    } else if (e.keyCode === 40) {
                        movePacman(2);
                    } else if (e.keyCode === 37) {
                        movePacman(3);
                    } else if (e.keyCode === 38) {
                        movePacman(4);
                    }
                } else if (e.keyCode === 68 && !PAUSE) {
                    /*if ( $("#canvas-paths").css("display") === "none" ) { 
                                          $("#canvas-paths").show();
                                      } else { 
                                          $("#canvas-paths").hide();
                                      }*/
                } else if (e.keyCode === 80 && !PACMAN_DEAD && !LOCK) {
                    if (PAUSE) {
                        resumeGame();
                    } else {
                        pauseGame();
                    }
                } else if (GAMEOVER) {
                    initHome();
                }
                //}
            }
        });
    });
</script>

</html>